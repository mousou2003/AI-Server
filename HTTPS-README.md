# HTTPS Configuration for Open WebUI

This setup configures Open WebUI to use HTTPS with SSL/TLS encryption via an nginx reverse proxy.

## üîí Security Features

- **SSL/TLS encryption** for all web traffic
- **HTTP to HTTPS redirection** (all HTTP requests automatically redirect to HTTPS)
- **Modern SSL configuration** with TLS 1.2+ and secure cipher suites
- **Security headers** including HSTS, X-Frame-Options, X-Content-Type-Options
- **Rate limiting** to prevent abuse
- **WebSocket support** for real-time features

## üöÄ Quick Start

### 1. Generate SSL Certificates

**On Windows (PowerShell):**
```powershell
.\generate-ssl-certs.ps1
```

**On Linux/Mac (Bash):**
```bash
chmod +x generate-ssl-certs.sh
./generate-ssl-certs.sh
```

### 2. Start the Services

```bash
docker compose up -d
```

### 3. Access the WebUI

Open your browser and navigate to:
- **HTTPS**: https://localhost (recommended)
- **HTTP**: http://localhost (automatically redirects to HTTPS)

## üîß Configuration Details

### Architecture
```
Browser ‚Üí nginx (port 443/80) ‚Üí open-webui (port 8080)
```

### Ports
- **Port 80**: HTTP (redirects to HTTPS)
- **Port 443**: HTTPS (SSL/TLS encrypted)
- **Port 11434**: Ollama API (direct access)
- **Port 11435**: Llama.cpp server (direct access)

### SSL Certificates
- **Development**: Self-signed certificates (generated by script)
- **Production**: Replace with valid certificates from a CA

## ‚ö†Ô∏è Browser Security Warning

Since we're using self-signed certificates for development, your browser will show a security warning. This is normal and expected.

**To proceed:**
1. Click "Advanced" or "Show details"
2. Click "Proceed to localhost (unsafe)" or similar option

## üè≠ Production Deployment

For production use, replace the self-signed certificates with valid certificates:

1. Obtain SSL certificates from a Certificate Authority (Let's Encrypt, etc.)
2. Replace the files in `./nginx/ssl/`:
   - `cert.pem` - Your SSL certificate
   - `key.pem` - Your private key
3. Update the server name in `nginx/nginx.conf` if needed
4. Restart the services: `docker compose restart nginx`

## üîß Customization

### nginx Configuration
Edit `./nginx/nginx.conf` to customize:
- SSL settings
- Security headers
- Rate limiting
- Proxy settings

### Certificate Renewal
For Let's Encrypt certificates, set up automatic renewal:
```bash
# Add to crontab for automatic renewal
0 2 * * 0 /path/to/certbot renew && docker compose restart nginx
```

## üîç Troubleshooting

### SSL Certificate Issues
```bash
# Check certificate validity
openssl x509 -in ./nginx/ssl/cert.pem -text -noout

# Verify certificate and key match
openssl x509 -noout -modulus -in ./nginx/ssl/cert.pem | openssl md5
openssl rsa -noout -modulus -in ./nginx/ssl/key.pem | openssl md5
```

### nginx Logs
```bash
# View nginx logs
docker logs nginx-proxy

# View real-time logs
docker logs -f nginx-proxy
```

### Test HTTPS Connection
```bash
# Test SSL certificate
openssl s_client -connect localhost:443 -servername localhost

# Test HTTP redirect
curl -I http://localhost
```

## üìù Files Created

- `nginx/nginx.conf` - nginx reverse proxy configuration
- `nginx/ssl/cert.pem` - SSL certificate
- `nginx/ssl/key.pem` - SSL private key
- `generate-ssl-certs.ps1` - PowerShell certificate generation script
- `generate-ssl-certs.sh` - Bash certificate generation script

## üîÑ Reverting to HTTP

To revert back to HTTP-only access:

1. Restore the original `docker-compose.yml`
2. Remove the nginx service
3. Change open-webui ports back to `"3000:8080"`
4. Update the Python script URLs back to `http://localhost:3000`
